<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HonorQR Chatbot</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link href="public/styles.css" rel="stylesheet">
    <style>
        .chat-container {
            max-height: 70vh;
            overflow-y: auto;
        }
        .chat-bubble {
            max-width: 60%;
            padding: 10px;
            border-radius: 20px;
            margin-bottom: 10px;
        }
        .user-bubble {
            background-color: #E2F7CB;
            align-self: flex-end;
        }
        .bot-bubble {
            background-color: #F2F2F2;
            align-self: flex-start;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans">
    <!-- Navigation Bar -->
    <header class="top-0 left-0 z-50 fixed border-gray-200 bg-white shadow-md border-b w-full">
        <div class="mx-auto px-4 sm:px-6 lg:px-8 max-w-screen-xl">
            <div class="flex justify-between items-center h-16">
                <div class="flex items-center">
                    <img src="IMAGES/logo.jpg" alt="HonorQR Logo" class="h-10">
                    <span class="ml-3 font-semibold text-gray-900 text-xl">HonorQR</span>
                </div>
                <nav class="md:flex hidden md:ml-4">
                    <ul class="flex space-x-8">
                        <li><a href="dashboard.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Home</a></li>
                        <li><a href="profile.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Profile</a></li>
                        <li><a href="privacy.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Privacy</a></li>
                        <li><a href="notifications.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Notifications</a></li>
                        <li><a href="billing.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Billing</a></li>
                        <li><a href="security.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Security</a></li>
                        <li><a href="logout.html" class="hover:bg-gray-100 px-3 py-2 rounded text-gray-900">Logout</a></li>
                    </ul>
                </nav>
                <div class="md:hidden">
                    <button class="hover:bg-gray-100 p-2 rounded text-gray-500" id="mobile-menu-button" aria-label="Toggle Menu">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
        <nav class="hidden md:hidden" id="mobile-menu">
            <ul class="flex flex-col border-gray-200 bg-gray-50 border-t">
                <li><a href="dashboard.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Home</a></li>
                <li><a href="profile.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Profile</a></li>
                <li><a href="privacy.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Privacy</a></li>
                <li><a href="notifications.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Notifications</a></li>
                <li><a href="billing.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Billing</a></li>
                <li><a href="security.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Security</a></li>
                <li><a href="logout.html" class="hover:bg-gray-100 px-4 py-2 text-gray-900">Logout</a></li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main class="mx-auto mt-20 p-4 container">
        <h1 class="mb-4 font-semibold text-3xl text-gray-900">HonorQR Chatbot</h1>
        <div class="flex flex-col bg-white shadow-lg p-6 rounded-lg h-[70vh]">
            <div id="chat-container" class="flex flex-col mb-4 p-4 chat-container">
                <!-- Chat messages will be appended here -->
            </div>
            <form id="chat-form" class="flex">
                <input type="text" id="user-input" name="user-input" class="p-2 border rounded-lg w-full" placeholder="Type your message...">
                <button type="submit" class="bg-blue-500 ml-2 px-4 py-2 rounded-lg text-white">Send</button>
            </form>
        </div>
    </main>

    <!-- Footer -->
    <footer class="bg-gray-900 py-8 text-white">
        <div class="mx-auto text-center container">
            <span class="font-bold text-sm">&copy; 2024 HonorQR. All rights reserved.</span>
            <div class="space-x-4 mt-4">
                <a href="#" class="text-gray-400 hover:text-white">Privacy Policy</a>
                <a href="#" class="text-gray-400 hover:text-white">Terms of Service</a>
                <a href="#" class="text-gray-400 hover:text-white">Contact</a>
            </div>
        </div>
    </footer>

    <script>
        function chatbot() {
            const chatContainer = document.getElementById('chat-container');
            const chatForm = document.getElementById('chat-form');
            const userInput = document.getElementById('user-input');

            const prompts = [
                ["hi", "hey", "hello", "good morning", "good afternoon"],
                ["how are you", "how is life", "how are things"],
                ["what are you doing", "what is going on", "what is up"],
                ["how old are you"],
                ["who are you", "are you human", "are you bot", "are you human or bot"],
                ["who created you", "who made you"],
                ["your name please", "your name", "may i know your name", "what is your name", "what call yourself"],
                ["i love you"],
                ["happy", "good", "fun", "wonderful", "fantastic", "cool"],
                ["bad", "bored", "tired"],
                ["help me", "tell me story", "tell me joke"],
                ["ah", "yes", "ok", "okay", "nice"],
                ["bye", "good bye", "goodbye", "see you later"],
                ["what should i eat today"],
                ["bro"],
                ["what", "why", "how", "where", "when"],
                ["no", "not sure", "maybe", "no thanks"],
                [""],
                ["haha", "ha", "lol", "hehe", "funny", "joke"],
                ["flip a coin", "heads or tails", "tails or heads", "head or tails", "head or tail", "tail or heads", "tail or head"],
                ["beer","buy me a beer","want a beer"]
            ];

            const replies = [
                ["Hello!", "Hi!", "Hey!", "Hi there!", "Howdy"],
                ["Fine... how are you?", "Pretty well, how are you?", "Fantastic, how are you?"],
                ["Nothing much", "About to go to sleep", "Can you guess?", "I don't know actually"],
                ["I am infinite"],
                ["I am just a bot", "I am a bot. What are you?"],
                ["The one true God, JavaScript"],
                ["I am nameless", "I don't have a name"],
                ["I love you too", "Me too"],
                ["Have you ever felt bad?", "Glad to hear it"],
                ["Why?", "Why? You shouldn't!", "Try watching TV"],
                ["What about?", "Once upon a time..."],
                ["Tell me a story", "Tell me a joke", "Tell me about yourself"],
                ["Bye", "Goodbye", "See you later"],
                ["Sushi", "Pizza"],
                ["Bro!"],
                ["Great question"],
                ["That's ok", "I understand", "What do you want to talk about?"],
                ["Please say something :("],
                ["Haha!", "Good one!"],
                ["Heads", "Tails"],
                ["You can buy me a beer at: <a href=\"https://www.buymeacoffee.com/scottwindon\" target=\"_blank\" style=\"text-decoration:underline;\">https://www.buymeacoffee.com/scottwindon</a>"]
            ];

            const alternative = ["Same", "Go on...", "Bro...", "Try again", "I'm listening...", "I don't understand :/"];
            const coronavirus = ["Please stay home", "Wear a mask", "Fortunately, I don't have COVID", "These are uncertain times"];

            chatForm.addEventListener('submit', function (e) {
                e.preventDefault();
                const userMessage = userInput.value.trim();
                if (userMessage) {
                    addMessage(userMessage, 'user');
                    userInput.value = '';
                    // Simulate bot response
                    setTimeout(() => {
                        const botResponse = getBotResponse(userMessage);
                        addMessage(botResponse, 'bot');
                    }, 1000);
                }
            });

            function addMessage(message, sender) {
                const messageBubble = document.createElement('div');
                messageBubble.classList.add('chat-bubble', sender === 'user' ? 'user-bubble' : 'bot-bubble');
                messageBubble.innerHTML = message;
                chatContainer.appendChild(messageBubble);
                chatContainer.scrollTop = chatContainer.scrollHeight;
            }

            function getBotResponse(input) {
                let product;

                // Remove non word/space chars
                let text = input.toLowerCase().replace(/[^\w\s]/gi, "").replace(/[\d]/gi, "").trim();
                text = text
                    .replace(/ a /g, " ") // 'tell me a story' -> 'tell me story'
                    .replace(/i feel /g, "")
                    .replace(/whats/g, "what is")
                    .replace(/please /g, "")
                    .replace(/ please/g, "")
                    .replace(/r u/g, "are you");

                if (compare(prompts, replies, text)) {
                    product = compare(prompts, replies, text);
                } else if (text.match(/thank/gi)) {
                    product = "You're welcome!"
                } else if (text.match(/(corona|covid|virus)/gi)) {
                    product = coronavirus[Math.floor(Math.random() * coronavirus.length)];
                } else {
                    product = alternative[Math.floor(Math.random() * alternative.length)];
                }

                return product;
            }

            function compare(promptsArray, repliesArray, string) {
                let reply;
                let replyFound = false;
                for (let x = 0; x < promptsArray.length; x++) {
                    for (let y = 0; y < promptsArray[x].length; y++) {
                        if (promptsArray[x][y] === string) {
                            let replies = repliesArray[x];
                            reply = replies[Math.floor(Math.random() * replies.length)];
                            replyFound = true;
                            break;
                        }
                    }
                    if (replyFound) {
                        break;
                    }
                }
                if (!reply) {
                    for (let x = 0; x < promptsArray.length; x++) {
                        for (let y = 0; y < promptsArray[x].length; y++) {
                            if (levenshtein(promptsArray[x][y], string) >= 0.75) {
                                let replies = repliesArray[x];
                                reply = replies[Math.floor(Math.random() * replies.length)];
                                replyFound = true;
                                break;
                            }
                        }
                        if (replyFound) {
                            break;
                        }
                    }
                }
                return reply;
            }

            function levenshtein(s1, s2) {
                var longer = s1;
                var shorter = s2;
                if (s1.length < s2.length) {
                    longer = s2;
                    shorter = s1;
                }
                var longerLength = longer.length;
                if (longerLength == 0) {
                    return 1.0;
                }
                return (longerLength - editDistance(longer, shorter)) / parseFloat(longerLength);
            }

            function editDistance(s1, s2) {
                s1 = s1.toLowerCase();
                s2 = s2.toLowerCase();

                var costs = new Array();
                for (var i = 0; i <= s1.length; i++) {
                    var lastValue = i;
                    for (var j = 0; j <= s2.length; j++) {
                        if (i == 0)
                            costs[j] = j;
                        else {
                            if (j > 0) {
                                var newValue = costs[j - 1];
                                if (s1.charAt(i - 1) != s2.charAt(j - 1))
                                    newValue = Math.min(Math.min(newValue, lastValue),
                                        costs[j]) + 1;
                                costs[j - 1] = lastValue;
                                lastValue = newValue;
                            }
                        }
                    }
                    if (i > 0)
                        costs[s2.length] = lastValue;
                }
                return costs[s2.length];
            }
        }

        document.addEventListener('DOMContentLoaded', function () {
            chatbot();
        });

        document.getElementById('mobile-menu-button').addEventListener('click', function () {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });
    </script>
</body>
</html>
